var currentLikeStatus=videoFeedbackCodes.NO_VOTE;let iconlist=`\n                <span id="like-dislike-element">\n                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-thumb-down likedislikeicon likedislike" id="dislikeButton" width="22" height="22" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">\n                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>\n                        <path d="M7 13v-8a1 1 0 0 0 -1 -1h-2a1 1 0 0 0 -1 1v7a1 1 0 0 0 1 1h3a4 4 0 0 1 4 4v1a2 2 0 0 0 4 0v-5h3a2 2 0 0 0 2 -2l-1 -5a2 3 0 0 0 -2 -2h-7a3 3 0 0 0 -3 3" />\n                    </svg>\n                    \n                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-thumb-up likedislikeicon likedislike" id="likeButton" width="22" height="22" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">\n                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>\n                        <path d="M7 11v8a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1v-7a1 1 0 0 1 1 -1h3a4 4 0 0 0 4 -4v-1a2 2 0 0 1 4 0v5h3a2 2 0 0 1 2 2l-1 5a2 3 0 0 1 -2 2h-7a3 3 0 0 1 -3 -3" />\n                    </svg>\n\n                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-message-dots likedislikeicon likedislike" id="commentBtn" width="22" height="22" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">\n                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>\n                        <path d="M4 21v-13a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v6a3 3 0 0 1 -3 3h-9l-4 4" />\n                        <line x1="12" y1="11" x2="12" y2="11.01" />\n                        <line x1="8" y1="11" x2="8" y2="11.01" />\n                        <line x1="16" y1="11" x2="16" y2="11.01" />\n                    </svg>\n                </span>\n                `;window.mobileAndTabletCheck=function(){let check=false;(function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))check=true})(navigator.userAgent||navigator.vendor||window.opera);return check};$(function(){if(typeof statsUpdateInterval==="undefined"||statsUpdateInterval==null){statsUpdateInterval=30}$("body").on("click",".play-videojs-list",function(e){e.preventDefault();$(".play-videojs-list").addClass("temp-play-videojs-list");$(".play-videojs-list").removeClass("play-videojs-list");setTimeout(()=>{$(".temp-play-videojs-list").addClass("play-videojs-list");$(".temp-play-videojs-list").removeClass("temp-play-videojs-list")},3e3);createVideoJs();let id=$(this).attr("data-id");let section=$(this).attr("data-section");let videoDetails=returnVideoDetails(section,id);window.location.hash="";$("#current-video-description").html($.parseHTML(videoDetails["description"]));$("#video-playlist-wrapper").html(videoPlaylistTemplate(section,trackVideosProgressData));$(".video-playlist-item[data-src="+id+"]").addClass("video-item-active");$(".video-playlist-item[data-src="+id+"] .fa-custom_icon").removeClass("fa-play-circle-o").addClass("fa-pause");$(".video-playlist-item[data-src="+id+"]").append(iconlist);setTimeout(()=>{playClassroomCourseVideo(videoDetails["url"],section,id,true)},1e3);$("#learnVideoModal").append('<div class="forwardIcon text-center" style="display:none; position: absolute;top: 44%;left: 80%; z-index: 9999; font-size:25px;"><i class="fa fa-forward"></i><span style="margin-bottom:50%"> 10</span></div><div class="backwardIcon text-center" style="display:none;position: absolute;top: 44%;left: 10%;z-index: 9999; font-size:25px;">10 <i class="fa fa-backward"></i></div><div class="volumeIcon text-center" style="position: absolute;z-index: 9999;top: 10%; left: 80%;font-size: 20px;"></div>');setTimeout(function(){$("#learnVideoModal").focus()},500);$("#learnVideoModal").attr("data-gfg-video-id",id);$("#current-video-description > p").css("padding","0px 10px");$("h4, p").filter(function(){return $.trim($(this).text().trim()).length===0}).remove()});$("body").on("click",".video-playlist-item",function(e){e.preventDefault();$(".video-playlist-item").removeClass("video-item-active").addClass("pe-none");$(".video-playlist-item .fa-custom_icon").removeClass("fa-pause").addClass("fa-play-circle-o");$(".likedislikeicon").remove();$(this).addClass("video-item-active");let id=$(this).attr("data-src");let section=$(this).attr("data-section");let videoDetails=returnVideoDetails(section,id);$(".video-playlist-item[data-src="+id+"]").append(iconlist);if(parseInt(videoDetails["type"])==1){createVideoJs();$(this).find(".fa-custom_icon").removeClass("fa-play-circle-o").addClass("fa-pause");$(".video-inner-src").css("opacity","0.2");$("#loader").removeClass("hide").css("display","block!important");$("#cancelPlayVideo").hide();$("#current-video-description").html("");setTimeout(()=>{$("#loader").addClass("hide");$("#cancelPlayVideo").show();$(".video-inner-src").css("opacity","1");playClassroomCourseVideo(videoDetails["url"],section,id,false);$("#current-video-description").html($.parseHTML(videoDetails["description"]));$("h4, p").filter(function(){return $.trim($(this).text().trim()).length===0}).remove();$("#current-video-description > p").css("padding","0px 10px");$(".video-playlist-item").removeClass("pe-none");$("#learnVideoModal").append('<div class="forwardIcon text-center" style="display:none; position: absolute;top: 44%;left: 80%; z-index: 9999; font-size:25px;"><i class="fa fa-forward"></i><span style="margin-bottom:50%"> 10</span></div><div class="backwardIcon text-center" style="display:none;position: absolute;top: 44%;left: 10%;z-index: 9999; font-size:25px;">10 <i class="fa fa-backward"></i></div><div class="volumeIcon text-center" style="position: absolute;z-index: 9999;top: 10%; left: 80%;font-size: 20px;"></div>');$("#learnVideoModal").attr("data-gfg-video-id",id)},1e3);setTimeout(function(){$("#learnVideoModal").focus()},500)}else{let elIndex=findElementIndex(id,section);window.location.hash=`${section}_${elIndex}`;$("#learnVideo").modal("hide");$(`#${section}_${elIndex}`).collapse("show")}});$("#learnVideo").on("hidden.bs.modal",function(){currentPlayer.pause();currentPlayer.reset();if($("#cancelPlayVideo").length>0){$("#cancelPlayVideo").trigger("click")}});$("body").on("click","#commentBtn",function(e){e.stopPropagation();let feedbackContent=prompt("Please enter your feedback");if(feedbackContent==null)return;let videoId=$(".video-playlist-item.video-item-active")[0].getAttribute("data-src");feedbackContent=feedbackContent.replace(/<\/?[^>]+(>|$)/g,"");if(feedbackContent==""){alert("Feedback body can't be  empty");return}$.ajax({type:"POST",url:"/user-course/stats/",data:{requestType:videoFeedbackCodes.ADD_FEEDBACK,videoId:btoa(videoId),batchId:btoa(batchId),trackId:btoa(trackId),feedback_content:feedbackContent},success:function(result){var response=result;var status=response["success"];if(status==true){$("#gfg-snackbar").text("Feedback Recorded!");$("#gfg-snackbar").addClass("show");setTimeout(function(){$("#gfg-snackbar").removeClass("show")},3e3)}},error:function(xhr,status,error){console.error(status)}})});$("body").on("click","#likeButton, #dislikeButton",function(e){e.stopPropagation();let videoId=$(".video-playlist-item.video-item-active")[0].getAttribute("data-src");let buttonType=$(this).attr("id");let action;if(buttonType=="likeButton"){action=videoFeedbackCodes.LIKE}else if(buttonType=="dislikeButton"){action=videoFeedbackCodes.DISLIKE}if(action==currentLikeStatus){action=videoFeedbackCodes.NO_VOTE}$.ajax({type:"POST",url:"/user-course/stats/",data:{requestType:"updateVideoLikeStatus",videoId:btoa(videoId),batchId:btoa(batchId),trackId:btoa(trackId),video_like_status:action},success:function(result){var response=result;var status=response["success"];let colorOfLikeBtn="black";let colorOfDislikeBtn="black";if(status==true){currentLikeStatus=parseInt(response["video_like_status"]);allVideosLikeStatus[videoId]=parseInt(response["video_like_status"]);allVideosLikeDislikeCounts[videoId]["likes_count"]=response["likes_count"];allVideosLikeDislikeCounts[videoId]["dislikes_count"]=response["dislikes_count"];setLikeStatus(response["likes_count"],response["dislikes_count"])}else{$("#likeButton").children().eq(1).css({stroke:`${colorOfLikeBtn}`});$("#dislikeButton").children().eq(1).css({stroke:`${colorOfDislikeBtn}`})}}})})});function playClassroomCourseVideo(url,section,id,show=true){var videoPlayerSavedSettings={};let level=JSON.parse(sessionStorage.getItem("videoPlayerSavedSettings"));currentPlayer=undefined;currentPlayer=videojs("learnVideoModal",{playbackRates:[.5,.75,1,1.25,1.5,2],html5:{nativeAudioTracks:false,nativeVideoTracks:false,hls:{debug:true,overrideNative:true,enableLowInitialPlaylist:true,smoothQualityChange:true}}},function(){$.each(level,function(key,value){if(key=="gfgVolumebar"){if(typeof value!=undefined&&value!==null){currentPlayer.volume(value)}}if(key=="gfgIsMute"){if(typeof value!=undefined&&value!==null&&value==true){$(".vjs-tech").prop("muted",true);videoPlayerSavedSettings["gfgIsMute"]=true;sessionStorage.setItem("videoPlayerSavedSettings",JSON.stringify(videoPlayerSavedSettings))}}})});subtitleUrl=url.replace(".m3u8",".vtt");subtitleUrl=subtitleUrl.replace(/%20/g,"+");subtitleUrl=subtitleUrl.replace("/hls/","/subtitles/");subtitleUrl=subtitleUrl.replace("/courses/","/subtitles/");let captionOption={kind:"captions",srclang:"en",label:"English Auto-Generated",src:subtitleUrl,default:true};currentPlayer.ready(function(){currentPlayer.addRemoteTextTrack(captionOption);this.src({src:url,type:"application/x-mpegURL",withCredentials:false});currentPlayer.hlsQualitySelector({});currentPlayer.play();this.hotkeys({volumeStep:.1,seekStep:10,enableModifiersForNumbers:false,alwaysCaptureHotkeys:true,forwardKey:function(event,player){if(event.which==39){$(".forwardIcon").show().delay(10).fadeOut();setTimeout(function(){$("#learnVideoModal").focus()},500)}return event.which==39},rewindKey:function(event,player){if(event.which==37){$(".backwardIcon").show().delay(10).fadeOut();setTimeout(function(){$("#learnVideoModal").focus()},500)}return event.which==37},volumeUpKey:function(event,player){if(event.which==38){var currentVolume=$(".vjs-volume-bar").attr("aria-valuenow");$(".volumeIcon").html('<i class="fa fa-volume-up"></i> '+currentVolume+"%");$(".volumeIcon").show().delay(50).fadeOut();setTimeout(function(){$("#learnVideoModal").focus()},500)}return event.which==38},volumeDownKey:function(event,player){if(event.which==40){$(".volumeIcon").html('<i class="fa fa-volume-down"></i> '+$(".vjs-volume-bar").attr("aria-valuenow")+"%");$(".volumeIcon").show().delay(50).fadeOut();setTimeout(function(){$("#learnVideoModal").focus()},500)}return event.which==40}})});currentPlayer.one("play",function(e){if(trackVideosProgressData&&trackVideosProgressData!={}&&id in trackVideosProgressData&&trackVideosProgressData[id]&&trackVideosProgressData[id]!=undefined){var watchedTime=parseInt(trackVideosProgressData[id].watched_time);var totalDuration=parseInt(trackVideosProgressData[id].total_duration);var remainingTime=totalDuration-watchedTime;if(remainingTime>statsUpdateInterval){currentPlayer.currentTime(watchedTime)}}$.each(level,function(key,value){if(key=="gfgRatebar"){if(typeof value!=undefined&&value!==null){currentPlayer.playbackRate(value)}}});var content='<style>.video-js:before{content: "'+user_email+'";}</style>';$("head").append(content);var watermark_align=["top-left","forth-quad","second-quad","bottom-right","center-left","top-right","third-quad","center-right","center-top","bottom-left","center","first-quad","center-bottom"];var counter=0;setInterval(function(){if(counter){currentPlayer.removeClass(watermark_align[counter-1])}else{currentPlayer.removeClass(watermark_align[watermark_align.length-1])}if(counter>=watermark_align.length){counter=0}currentPlayer.addClass(watermark_align[counter]);counter++},5e4)});var lastUpdateTime=0;var updatedOnce=false;currentPlayer.on("timeupdate",function(e){var whereUserAt=currentPlayer.currentTime();var ceilTime=Math.ceil(whereUserAt);var totalDuration=Math.ceil(currentPlayer.duration());var watchedPercentage=parseInt(ceilTime*100/totalDuration);$("#gfg-video-progress-"+id).css({display:"block",width:`${watchedPercentage}%`});if(!updatedOnce||(ceilTime%statsUpdateInterval==0||Math.abs(ceilTime-lastUpdateTime)>statsUpdateInterval)&&String(ceilTime)!=String(lastUpdateTime)){updatedOnce=true;lastUpdateTime=ceilTime;$.ajax({type:"POST",url:"/user-course/stats/",data:{requestType:"saveUserVideoProgress",utoken:$("#utoken").text(),videoId:btoa(id),batchId:btoa(batchId),trackId:btoa(trackId),totalDuration:totalDuration,watchedTime:ceilTime},success:function(result){var response=result;var status=response["success"];if(status==true){if(id in trackVideosProgressData){trackVideosProgressData[id]["watched_time"]=ceilTime}else{trackVideosProgressData[id]={watched_time:ceilTime,total_duration:totalDuration}}}}})}});currentPlayer.on("error",function(e){errorHandling(e,"learnVideo",currentPlayer)});currentPlayer.on("ratechange",function(){setTimeout(function(){$("#learnVideoModal").focus()},500);videoPlayerSavedSettings["gfgRatebar"]=currentPlayer.playbackRate();sessionStorage.setItem("videoPlayerSavedSettings",JSON.stringify(videoPlayerSavedSettings))});currentPlayer.on("volumechange",function(){if(currentPlayer.volume()!==null||currentPlayer.volume()!==undefined){videoPlayerSavedSettings["gfgVolumebar"]=currentPlayer.volume();sessionStorage.setItem("videoPlayerSavedSettings",JSON.stringify(videoPlayerSavedSettings))}});$(".vjs-mute-control").on("click",function(e){if($(".vjs-tech").prop("muted")){videoPlayerSavedSettings["gfgIsMute"]=true}else{videoPlayerSavedSettings["gfgIsMute"]=false}sessionStorage.setItem("videoPlayerSavedSettings",JSON.stringify(videoPlayerSavedSettings))});currentPlayer.on("ended",function(){if(videoPlaylistArr[section]&&parseInt(videoPlaylistArr[section][videoPlaylistArr[section].length-1]["id"])!=id*1&&nextVideoIndex(section,id)!=-1){$("#loader").removeClass("hide").css("display","block!important");$(".video-inner-src").css("opacity","0.55")}else{section=null;id=null;return}$("#cancelPlayVideo").on("click",function(e){id=null;section=null;$("#loader").addClass("hide");$(".video-inner-src").css("opacity","1");return});setTimeout(()=>{if(section&&id&&videoPlaylistArr[section]&&parseInt(videoPlaylistArr[section][videoPlaylistArr[section].length-1]["id"])!=id*1&&nextVideoIndex(section,id)!=-1){playNextVideo(section,id)}id=null;section=null},3e3)});currentLikeStatus=allVideosLikeStatus[id];try{setLikeStatus(allVideosLikeDislikeCounts[id]["likes_count"],allVideosLikeDislikeCounts[id]["dislikes_count"])}catch(ex){setLikeStatus(likes_count=0,dislikes_count=0)}let videoDetails=returnVideoDetails(section,id);$("#videoTitle").text(videoDetails["title"]);if(show){$("#learnVideo").modal("show")}}function returnVideoDetails(section,id){let data=videoPlaylistArr[section].find(obj=>{return obj["id"]==id});return data}function videoPlaylistTemplate(section,trackVideosProgressData){let template="";videoPlaylistArr[section].forEach(o=>{if(o.id){template+=`<li class="list-group-item playlist-card video-playlist-item" data-src="${o.id}" data-section="${section}">\n                                <p style="padding: 0px">`;if(o.type==1){template+=`<span class="fa fa-play-circle-o fa-custom_icon"></span>&nbsp;`}else if(o.type==0){template+=`<span class="fa fa-file-o"></span>&nbsp;`}template+=`  <span style="font-size: 13px">${o.title.replace("Video -","")}</span>\n                              </p>`;if(o.type==1){var watchTime=0;var display="none";if(o.id in trackVideosProgressData&&trackVideosProgressData[o.id].watched_percentage>0){var watchTime=trackVideosProgressData[o.id].watched_percentage;var display="block"}template+=` <div class="video-progress--light-grey"> \n                    <div class="video-progress-container video-progress-bar" id="gfg-video-progress-${o.id}" style="display:${display}; width:${watchTime}%"></div> </div>`}template+=`</li>`}});return template}function playNextVideo(section,id){let nextIndex=nextVideoIndex(section,id);if(nextIndex&&nextIndex!=-1){$(`.video-playlist-item[data-section=${section}][data-src=${videoPlaylistArr[section][nextIndex]["id"]}]`).click()}else{currentPlayer.pause();currentPlayer.reset();$("#loader").addClass("hide");$("#cancelPlayVideo").show();$(".video-inner-src").css("opacity","1")}}function findElementIndex(id,section){let index=videoPlaylistArr[section].findIndex(o=>{return o.id==id});return index!=null||index!=undefined?index:-1}function nextVideoIndex(section,currentId){if(videoPlaylistArr[section]&&videoPlaylistArr[section].length&&videoPlaylistArr[section][videoPlaylistArr[section].length-1]["id"]!=currentId*1){let index=findElementIndex(currentId,section);let videoDetails=index!=-1?videoPlaylistArr[section][index+1]:null;if(!videoDetails||videoDetails["type"]!=1){return-1}return index+1}else{return-1}}function createVideoJs(src){disposePlayer(true);var videoDiv=document.getElementById("video-src");var video=document.createElement("video");video.id="learnVideoModal";video.className="video-js video-inner-src vjs-default-skin";video.setAttribute("controls","controls");video.setAttribute("autoplay","autoplay");video.setAttribute("oncontextmenu","return false;");video.setAttribute("style","width: 100%!important; padding-left: 0px; padding-right: 0px");videoDiv.appendChild(video)}function disposePlayer(dispose=true){if(currentPlayer&&currentPlayer!=undefined&&dispose){currentPlayer.dispose()}}function errorHandling(e,modalId,curPlayer){e.stopImmediatePropagation();var errorObj=curPlayer.player().error();$("#gfg-snackbar").text(errorObj.message).addClass("show");setTimeout(()=>{$("#gfg-snackbar").removeClass("show").addClass("hide");$("#"+modalId).modal("hide")},3e3)}function setLikeStatus(likes_count=0,dislikes_count=0){let colorOfLikeBtn="black";let colorOfDislikeBtn="black";switch(currentLikeStatus){case videoFeedbackCodes.LIKE:colorOfLikeBtn="#308D46";break;case videoFeedbackCodes.DISLIKE:colorOfDislikeBtn="#308D46";break;default:break}$("#likeButton").children().eq(1).css({stroke:`${colorOfLikeBtn}`});$("#dislikeButton").children().eq(1).css({stroke:`${colorOfDislikeBtn}`})}